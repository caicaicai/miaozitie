<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å–µæ³¨éŸ³ - æ–‡ç« æ‹¼éŸ³æ³¨éŸ³å·¥å…·</title>
    <script src="pinyin-pro.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .nav-link {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .control-panel {
            padding: 25px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .input-section {
            margin-bottom: 20px;
        }

        .input-section label {
            display: block;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .text-input {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            line-height: 1.8;
            resize: vertical;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .text-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .text-input::placeholder {
            color: #aaa;
        }

        .options-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            align-items: center;
        }

        .option-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .option-item label {
            font-size: 14px;
            color: #555;
            white-space: nowrap;
        }

        .option-item input[type="number"],
        .option-item select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            width: 80px;
        }

        .option-item select {
            width: auto;
        }

        .option-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(17, 153, 142, 0.4);
        }

        .btn-print {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-print:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(240, 147, 251, 0.4);
        }

        .btn-clear {
            background: #6c757d;
            color: white;
        }

        .btn-clear:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .preview-area {
            padding: 30px;
            min-height: 300px;
        }

        .no-content {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 18px;
        }

        .no-content::before {
            content: 'ğŸ“–';
            display: block;
            font-size: 60px;
            margin-bottom: 20px;
        }

        /* æ³¨éŸ³æ–‡ç« æ ·å¼ */
        .pinyin-article {
            line-height: 2.2;
            text-align: justify;
        }

        .pinyin-article .title {
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .pinyin-article .paragraph {
            margin-bottom: 12px;
            text-indent: 2em;
        }

        /* Ruby æ³¨éŸ³æ ·å¼ */
        ruby {
            ruby-align: center;
        }

        ruby rt {
            font-size: 0.5em;
            color: #e74c3c;
            font-weight: normal;
            letter-spacing: 0;
        }

        /* æ ‡ç‚¹ç¬¦å·ä¸éœ€è¦æ³¨éŸ³ */
        .punctuation {
            display: inline;
        }

        /* å­—ä½“å¤§å°æ§åˆ¶ */
        .font-size-small .pinyin-article {
            font-size: 18px;
        }

        .font-size-medium .pinyin-article {
            font-size: 24px;
        }

        .font-size-large .pinyin-article {
            font-size: 30px;
        }

        .font-size-xlarge .pinyin-article {
            font-size: 36px;
        }

        /* æ‹¼éŸ³é¢œè‰²é€‰é¡¹ */
        .pinyin-red ruby rt {
            color: #e74c3c;
        }

        .pinyin-blue ruby rt {
            color: #3498db;
        }

        .pinyin-green ruby rt {
            color: #27ae60;
        }

        .pinyin-gray ruby rt {
            color: #7f8c8d;
        }

        /* ç¤ºä¾‹æ•…äº‹æŒ‰é’® */
        .example-stories {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed #ddd;
        }

        .example-stories label {
            font-size: 14px;
            color: #666;
            margin-right: 10px;
        }

        .story-btn {
            padding: 6px 12px;
            margin: 5px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 15px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .story-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* é¡µè„šæ ·å¼ */
        .footer {
            background: #f8f9fa;
            border-top: 2px solid #e9ecef;
            padding: 30px;
            margin-top: 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-section h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: bold;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-section li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .footer-section a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .footer-section a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .footer-section .description {
            color: #666;
            font-size: 14px;
        }

        .footer-section p {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
            margin: 8px 0;
        }

        .github-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: #24292e;
            color: white !important;
            border-radius: 8px;
            font-size: 14px;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .github-link:hover {
            background: #333;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            text-decoration: none !important;
        }

        .footer-note {
            color: #999;
            font-size: 12px;
            font-style: italic;
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
                max-width: 100%;
            }

            .header,
            .control-panel,
            .footer {
                display: none;
            }

            .preview-area {
                padding: 15mm;
            }

            .pinyin-article {
                font-size: 18px;
                line-height: 2.2;
            }

            .pinyin-article .title {
                margin-bottom: 10px;
            }

            .pinyin-article .paragraph {
                margin-bottom: 8px;
            }

            ruby rt {
                color: #333 !important;
            }

            @page {
                size: A4 portrait;
                margin: 15mm;
            }
        }

        /* å“åº”å¼ */
        @media (max-width: 600px) {
            .header h1 {
                font-size: 28px;
            }

            .options-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ± å–µæ³¨éŸ³</h1>
            <p>æŠŠæ•…äº‹å˜æˆå¸¦æ‹¼éŸ³çš„æ–‡ç« ï¼Œè®©å°æœ‹å‹è½»æ¾é˜…è¯»ï¼</p>
            <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <a href="index.html" class="nav-link">ğŸ“ ç¬”ç”»ç»ƒä¹ </a>
                <a href="chaozi.html" class="nav-link">âœï¸ æŠ„å­—æ¨¡å¼</a>
            </div>
        </div>

        <div class="control-panel">
            <div class="input-section">
                <label>ğŸ“– è¾“å…¥æ–‡ç« å†…å®¹ï¼š</label>
                <textarea 
                    id="textInput" 
                    class="text-input" 
                    placeholder="åœ¨è¿™é‡Œç²˜è´´æˆ–è¾“å…¥æ•…äº‹ã€æ–‡ç« å†…å®¹...

ä¾‹å¦‚ï¼š
å°çŒ«å’ªå–œæ¬¢åœ¨é˜³å…‰ä¸‹ç¡è§‰ã€‚æ¯å¤©æ—©ä¸Šï¼Œå®ƒéƒ½ä¼šæ‰¾ä¸€ä¸ªæ¸©æš–çš„åœ°æ–¹ï¼Œèœ·æˆä¸€å›¢ï¼Œäº«å—é˜³å…‰çš„æ¸©æš–ã€‚"></textarea>
            </div>

            <div class="options-row">
                <div class="option-item">
                    <label>å­—ä½“å¤§å°ï¼š</label>
                    <select id="fontSize">
                        <option value="small">å° (18px)</option>
                        <option value="medium" selected>ä¸­ (24px)</option>
                        <option value="large">å¤§ (30px)</option>
                        <option value="xlarge">ç‰¹å¤§ (36px)</option>
                    </select>
                </div>

                <div class="option-item">
                    <label>æ‹¼éŸ³é¢œè‰²ï¼š</label>
                    <select id="pinyinColor">
                        <option value="red" selected>çº¢è‰²</option>
                        <option value="blue">è“è‰²</option>
                        <option value="green">ç»¿è‰²</option>
                        <option value="gray">ç°è‰²</option>
                    </select>
                </div>

                <div class="option-item">
                    <label>
                        <input type="checkbox" id="showTone" checked>
                        æ˜¾ç¤ºå£°è°ƒ
                    </label>
                </div>

                <div class="option-item">
                    <label>
                        <input type="checkbox" id="splitParagraph" checked>
                        è‡ªåŠ¨åˆ†æ®µ
                    </label>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="convertToPinyin()">âœ¨ ç”Ÿæˆæ³¨éŸ³</button>
                <button class="btn btn-print" onclick="printArticle()">ğŸ–¨ï¸ æ‰“å°æ–‡ç« </button>
                <button class="btn btn-clear" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
            </div>

            <div class="example-stories">
                <label>ğŸ“š ç¤ºä¾‹æ•…äº‹ï¼š</label>
                <button class="story-btn" onclick="loadStory('fox')">ğŸ¦Š ç‹ç‹¸å’Œè‘¡è„</button>
                <button class="story-btn" onclick="loadStory('rabbit')">ğŸ¢ é¾Ÿå…”èµ›è·‘</button>
                <button class="story-btn" onclick="loadStory('crow')">ğŸ¦ ä¹Œé¸¦å–æ°´</button>
                <button class="story-btn" onclick="loadStory('poem')">ğŸŒ¸ é™å¤œæ€</button>
            </div>
        </div>

        <div class="preview-area font-size-medium pinyin-red" id="previewArea">
            <div class="no-content">
                è¾“å…¥æ–‡ç« å†…å®¹åç‚¹å‡»"ç”Ÿæˆæ³¨éŸ³"<br>
                å³å¯ç”Ÿæˆå¸¦æ‹¼éŸ³çš„æ–‡ç« 
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ğŸ“ åŸºäºå¼€æºæŠ€æœ¯</h4>
                    <ul>
                        <li>
                            <a href="https://github.com/zh-lx/pinyin-pro" target="_blank" rel="noopener noreferrer">
                                Pinyin Pro
                            </a>
                            <span class="description">- ä¸“ä¸šæ±‰å­—æ‹¼éŸ³è½¬æ¢åº“</span>
                        </li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ğŸ“¦ å¼€æºé¡¹ç›®</h4>
                    <p>
                        æœ¬é¡¹ç›®å·²åœ¨ GitHub å¼€æºï¼Œæ¬¢è¿ Starã€Fork å’Œè´¡çŒ®ï¼
                    </p>
                    <a href="https://github.com/caicaicai/miaozitie" target="_blank" rel="noopener noreferrer" class="github-link">
                        <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                        GitHub: caicaicai/miaozitie
                    </a>
                </div>
                <div class="footer-section">
                    <h4>ğŸ“„ è®¸å¯è¯</h4>
                    <p>MIT License Â© 2024</p>
                    <p class="footer-note">
                        ä¸“ä¸ºå°å­¦ç”Ÿè®¾è®¡çš„æ‹¼éŸ³æ³¨éŸ³å·¥å…·<br>
                        è®©é˜…è¯»å˜å¾—æ›´ç®€å•ï¼
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // ç¤ºä¾‹æ•…äº‹åº“
        const stories = {
            fox: `ç‹ç‹¸å’Œè‘¡è„

ä¸€åªç‹ç‹¸æ¥åˆ°ä¸€ä¸ªè‘¡è„æ¶ä¸‹ã€‚è‘¡è„æ¶ä¸ŠæŒ‚æ»¡äº†ä¸€ä¸²ä¸²æ™¶è¹å‰”é€çš„è‘¡è„ï¼Œåœ¨é˜³å…‰ä¸‹é—ªé—ªå‘å…‰ã€‚

ç‹ç‹¸é¦‹å¾—ç›´æµå£æ°´ï¼Œå®ƒè·³èµ·æ¥å»å¤Ÿè‘¡è„ï¼Œå¯æ˜¯è‘¡è„å¤ªé«˜äº†ï¼Œå¤Ÿä¸åˆ°ã€‚å®ƒåˆè·³äº†å‡ æ¬¡ï¼Œè¿˜æ˜¯å¤Ÿä¸åˆ°ã€‚

ç‹ç‹¸æƒ³ä¸å‡ºåŠæ³•ï¼Œåªå¥½èµ°å¼€äº†ã€‚å®ƒè¾¹èµ°è¾¹è¯´ï¼š"è¿™äº›è‘¡è„è‚¯å®šæ˜¯é…¸çš„ï¼Œä¸å¥½åƒï¼"

è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼šæœ‰äº›äººå¾—ä¸åˆ°æƒ³è¦çš„ä¸œè¥¿ï¼Œå°±è¯´é‚£ä¸œè¥¿ä¸å¥½ã€‚`,

            rabbit: `é¾Ÿå…”èµ›è·‘

ä»å‰ï¼Œæœ‰ä¸€åªéª„å‚²çš„å…”å­å’Œä¸€åªæ…¢ååçš„ä¹Œé¾Ÿã€‚

æœ‰ä¸€å¤©ï¼Œå…”å­å˜²ç¬‘ä¹Œé¾Ÿèµ°å¾—æ…¢ã€‚ä¹Œé¾Ÿè¯´ï¼š"æˆ‘ä»¬æ¥æ¯”èµ›è·‘æ­¥å§ï¼"å…”å­å“ˆå“ˆå¤§ç¬‘ï¼ŒåŒæ„äº†ã€‚

æ¯”èµ›å¼€å§‹äº†ã€‚å…”å­é£å¿«åœ°è·‘åœ¨å‰é¢ï¼Œå¾ˆå¿«å°±çœ‹ä¸è§ä¹Œé¾Ÿäº†ã€‚å…”å­å¿ƒæƒ³ï¼š"ä¹Œé¾Ÿè·‘å¾—é‚£ä¹ˆæ…¢ï¼Œæˆ‘å…ˆç¡ä¸€è§‰å§ã€‚"äºæ˜¯ï¼Œå®ƒèººåœ¨ä¸€æ£µå¤§æ ‘ä¸‹ç¡ç€äº†ã€‚

ä¹Œé¾Ÿè™½ç„¶è·‘å¾—æ…¢ï¼Œä½†æ˜¯å®ƒä¸€ç›´åšæŒå¾€å‰èµ°ï¼Œä¸€æ­¥ä¹Ÿæ²¡æœ‰åœä¸‹æ¥ã€‚

å½“å…”å­é†’æ¥æ—¶ï¼Œå‘ç°ä¹Œé¾Ÿå·²ç»å¿«åˆ°ç»ˆç‚¹äº†ï¼å…”å­æ‹¼å‘½è¿½èµ¶ï¼Œå¯æ˜¯å·²ç»æ¥ä¸åŠäº†ã€‚ä¹Œé¾Ÿèµ¢å¾—äº†æ¯”èµ›ã€‚

è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼šéª„å‚²ä½¿äººè½åï¼ŒåšæŒå°±æ˜¯èƒœåˆ©ï¼`,

            crow: `ä¹Œé¸¦å–æ°´

ä¸€åªä¹Œé¸¦å£æ¸´äº†ï¼Œåˆ°å¤„æ‰¾æ°´å–ã€‚å®ƒé£å•Šé£ï¼Œç»ˆäºçœ‹è§ä¸€ä¸ªç“¶å­ï¼Œç“¶å­é‡Œæœ‰æ°´ã€‚

å¯æ˜¯ï¼Œç“¶å­é‡Œçš„æ°´ä¸å¤šï¼Œç“¶å£åˆå°ï¼Œä¹Œé¸¦æ€ä¹ˆä¹Ÿå–ä¸åˆ°æ°´ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿ

ä¹Œé¸¦æƒ³åˆ°äº†ä¸€ä¸ªå¥½åŠæ³•ã€‚å®ƒçœ‹è§æ—è¾¹æœ‰è®¸å¤šå°çŸ³å­ï¼Œå°±ç”¨å˜´æŠŠå°çŸ³å­ä¸€é¢—ä¸€é¢—åœ°è¡”èµ·æ¥ï¼Œæ”¾è¿›ç“¶å­é‡Œã€‚

çŸ³å­è¶Šæ”¾è¶Šå¤šï¼Œç“¶å­é‡Œçš„æ°´ä¹Ÿè¶Šå‡è¶Šé«˜ã€‚ç»ˆäºï¼Œæ°´å‡åˆ°äº†ç“¶å£ï¼Œä¹Œé¸¦å–åˆ°æ°´äº†ï¼

è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼šé‡åˆ°å›°éš¾è¦å¤šåŠ¨è„‘ç­‹ï¼Œå°±èƒ½æƒ³å‡ºå¥½åŠæ³•ã€‚`,

            poem: `é™å¤œæ€

åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚
ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚

è¿™æ˜¯å”ä»£è¯—äººæç™½å†™çš„ä¸€é¦–è¯—ã€‚è¯—äººåœ¨ä¸€ä¸ªå®‰é™çš„å¤œæ™šï¼Œçœ‹åˆ°çª—å‰çš„æœˆå…‰æ´’åœ¨åœ°ä¸Šï¼Œå°±åƒé“ºäº†ä¸€å±‚ç™½éœœã€‚ä»–æŠ¬èµ·å¤´çœ‹ç€å¤©ä¸Šçš„æ˜æœˆï¼Œä¸ç¦æƒ³èµ·äº†è¿œæ–¹çš„å®¶ä¹¡ã€‚

è¿™é¦–è¯—ç”¨ç®€å•çš„è¯­è¨€ï¼Œè¡¨è¾¾äº†è¯—äººæ·±æ·±çš„æ€ä¹¡ä¹‹æƒ…ã€‚`
        };

        // åŠ è½½ç¤ºä¾‹æ•…äº‹
        function loadStory(storyKey) {
            const story = stories[storyKey];
            if (story) {
                document.getElementById('textInput').value = story;
            }
        }

        // åˆ¤æ–­æ˜¯å¦æ˜¯æ ‡ç‚¹ç¬¦å·
        function isPunctuation(char) {
            return /[ï¼Œã€‚ï¼ï¼Ÿã€ï¼›ï¼š""''ï¼ˆï¼‰ã€ã€‘ã€Šã€‹â€¦â€”\s\n\r,.!?;:'"()\[\]<>]/.test(char);
        }

        // åˆ¤æ–­æ˜¯å¦æ˜¯æ±‰å­—
        function isChineseChar(char) {
            return /[\u4e00-\u9fa5]/.test(char);
        }

        // è½¬æ¢ä¸ºæ³¨éŸ³
        function convertToPinyin() {
            const text = document.getElementById('textInput').value.trim();
            if (!text) {
                alert('è¯·å…ˆè¾“å…¥æ–‡ç« å†…å®¹ï¼');
                return;
            }

            const showTone = document.getElementById('showTone').checked;
            const splitParagraph = document.getElementById('splitParagraph').checked;
            const fontSize = document.getElementById('fontSize').value;
            const pinyinColor = document.getElementById('pinyinColor').value;

            // è·å–æ‹¼éŸ³ï¼ˆå¸¦å£°è°ƒæˆ–ä¸å¸¦ï¼‰
            const pinyinResult = pinyinPro.pinyin(text, { 
                toneType: showTone ? 'symbol' : 'none',
                type: 'array'
            });

            // æ„å»º HTML
            let html = '<div class="pinyin-article">';

            // åˆ†æ®µå¤„ç†
            const paragraphs = splitParagraph ? text.split(/\n+/) : [text];

            paragraphs.forEach((para, paraIndex) => {
                if (!para.trim()) return;

                // æ£€æŸ¥æ˜¯å¦æ˜¯æ ‡é¢˜ï¼ˆç¬¬ä¸€æ®µä¸”è¾ƒçŸ­ï¼‰
                const isTitle = paraIndex === 0 && para.length < 20 && !para.includes('ã€‚');

                html += isTitle ? '<div class="title">' : '<div class="paragraph">';

                // è®¡ç®—å½“å‰æ®µè½åœ¨åŸæ–‡ä¸­çš„èµ·å§‹ä½ç½®
                let charIndex = 0;
                for (let i = 0; i < paraIndex; i++) {
                    // è®¡ç®—ä¹‹å‰æ®µè½çš„é•¿åº¦ï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰
                    const prevPara = paragraphs[i];
                    charIndex += prevPara.length;
                    // åŠ ä¸Šæ¢è¡Œç¬¦çš„æ•°é‡
                    const match = text.substring(charIndex).match(/^\n+/);
                    if (match) {
                        charIndex += match[0].length;
                    }
                }

                // è®¡ç®—å½“å‰æ®µè½åœ¨åŸæ–‡ä¸­çš„å®é™…èµ·å§‹ç´¢å¼•
                let textIndex = text.indexOf(para, paraIndex === 0 ? 0 : text.indexOf(paragraphs[paraIndex - 1]) + paragraphs[paraIndex - 1].length);

                // éå†æ®µè½ä¸­çš„æ¯ä¸ªå­—ç¬¦
                for (let i = 0; i < para.length; i++) {
                    const char = para[i];
                    const globalIndex = textIndex + i;

                    if (isChineseChar(char)) {
                        const py = pinyinResult[globalIndex] || '';
                        html += `<ruby>${char}<rt>${py}</rt></ruby>`;
                    } else if (isPunctuation(char)) {
                        // æ ‡ç‚¹ç¬¦å·ä¿æŒåŸæ ·
                        if (char === '\n') {
                            html += '<br>';
                        } else {
                            html += `<span class="punctuation">${char}</span>`;
                        }
                    } else {
                        // å…¶ä»–å­—ç¬¦ï¼ˆæ•°å­—ã€å­—æ¯ç­‰ï¼‰
                        html += char;
                    }
                }

                html += '</div>';
            });

            html += '</div>';

            // æ›´æ–°é¢„è§ˆåŒºåŸŸ
            const previewArea = document.getElementById('previewArea');
            previewArea.innerHTML = html;

            // åº”ç”¨æ ·å¼
            previewArea.className = `preview-area font-size-${fontSize} pinyin-${pinyinColor}`;
        }

        // æ‰“å°æ–‡ç« 
        function printArticle() {
            const previewArea = document.getElementById('previewArea');
            if (previewArea.querySelector('.no-content')) {
                alert('è¯·å…ˆç”Ÿæˆæ³¨éŸ³æ–‡ç« ï¼');
                return;
            }
            window.print();
        }

        // æ¸…ç©º
        function clearAll() {
            document.getElementById('textInput').value = '';
            document.getElementById('previewArea').innerHTML = `
                <div class="no-content">
                    è¾“å…¥æ–‡ç« å†…å®¹åç‚¹å‡»"ç”Ÿæˆæ³¨éŸ³"<br>
                    å³å¯ç”Ÿæˆå¸¦æ‹¼éŸ³çš„æ–‡ç« 
                </div>
            `;
        }

        // ç›‘å¬è®¾ç½®å˜åŒ–ï¼Œå®æ—¶æ›´æ–°æ ·å¼
        document.getElementById('fontSize').addEventListener('change', function() {
            const previewArea = document.getElementById('previewArea');
            if (!previewArea.querySelector('.no-content')) {
                updatePreviewStyle();
            }
        });

        document.getElementById('pinyinColor').addEventListener('change', function() {
            const previewArea = document.getElementById('previewArea');
            if (!previewArea.querySelector('.no-content')) {
                updatePreviewStyle();
            }
        });

        function updatePreviewStyle() {
            const fontSize = document.getElementById('fontSize').value;
            const pinyinColor = document.getElementById('pinyinColor').value;
            const previewArea = document.getElementById('previewArea');
            previewArea.className = `preview-area font-size-${fontSize} pinyin-${pinyinColor}`;
        }
    </script>
</body>
</html>

